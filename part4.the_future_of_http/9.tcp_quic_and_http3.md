## TCP，QUIC and HTTP/3

HTTP/2的目的主要是通过允许单个多路复用连接来改善HTTP协议固有的效率低下问题。在HTTP/1.1，该连接没有得到充分利用，因为一次只能用于一种资源。如果在响应请求时存在时延（比如因为服务器正忙于生成该资源），连接被blocked并且没有被使用。HTTP/2允许多个资源使用同一个连接，因此在这种情况下其他资源可以使用该连接。

除了避免浪费连接之外，HTTP/2还提高了性能，因为HTTP连接本书效率较低。建立HTTP连接需要一定的成本；否则多路复用不会得到真正的好处。成本不是由HTTP本身引起的，而是由用于建立此连接的两种基础技术决定的：HTTPS中使用TCP和TLS。

在本章中，我调查这些低效的问题，并表明尽管HTTP/2可以更好地处理这些低效的问题，但是某些情况下，由于这些低效的问题，HTTP/2可能比HTTP/1.1更慢。然后我讨论QUIC，做了一些这些问题的改进。

### 9.1 TCP inefficiencies and HTTP

HTTP依赖网络连接保证数据的可靠传递和有序性。直到最近，这种可靠连接使用TCP来保证。TCP连接两个端（典型的是浏览器和Web服务器）然后确保消息传递的可靠性，如果消息丢失就重传，并且保证消息在传递给应用层（HTTP）时保持有序性。HTTP不需要实现这些复杂的内容，而是假定已经满足这些条件。协议建立在这些假设之上。

TCP通过给每个TCP包分配一个序列号，然后再接收端重排数据包（如果没有按序到达）或者要求重传丢失序列号的包（如果包丢失）。TCP在CWND的基础上工作（这也构成了HTTP/2的流控制工作方式；参阅第7章），由此确定可发送的最大数据量（CWND大小），已发送的消息减少了窗口大小，已确认的消息增大了窗口的大小。窗口开始时很小，但是随着时间推移而增长，因为网络容量表示可以承载更多的数据。如果客户端无法跟上进度，窗口也会缩小。